# creating region space 
import pandas as pd
import numpy as np 
import networkx as nx
from bokeh.io import show, save, output_file
from bokeh.models import Range1d, Circle, MultiLine, EdgesAndLinkedNodes , NodesAndLinkedEdges , TapTool, HoverTool
from bokeh.plotting import figure
from bokeh.plotting import from_networkx
from bokeh.models import CustomJS, Select

node_positions = pd.read_pickle('region_node_info_2.pkl')
node_positions.label = node_positions.label.astype(int)

#node attributes 
pos = node_positions.set_index('label')['coordinates'].to_dict()
node_group = node_positions.set_index('label')['group'].to_dict()
node_color = node_positions.set_index('label')['color'].to_dict()
node_name = node_positions.set_index('label')['region'].to_dict()
node_rayon = node_positions.set_index('label')['title_x'].to_dict()
node_okeds_final = node_positions.set_index('label')['regions_spec'].to_dict()
size = node_positions.set_index('label')['node_size'].to_dict()
node_eci = node_positions.set_index('label')['eci'].to_dict()
node_emp = node_positions.set_index('label')['employment'].to_dict()

# create a network
data = pd.read_csv('edge_list_regions.csv')
data = data.astype({'source': int, 'target':int})
G = nx.from_pandas_edgelist(data, edge_attr=True)


# set attributes 
nx.set_node_attributes(G, node_group , 'group')
nx.set_node_attributes(G, node_color , 'color')
nx.set_node_attributes(G, node_name , 'name')
nx.set_node_attributes(G, node_rayon , 'rayon')
nx.set_node_attributes(G,node_okeds_final, 'okeds' )
nx.set_node_attributes(G, size, 'size')
nx.set_node_attributes(G, node_eci, 'eci')
nx.set_node_attributes(G, node_emp, 'Employment')

from bokeh.layouts import column
import copy

from bokeh.models import EdgesAndLinkedNodes , EdgesAndLinkedNodes

title = 'Пространство регионов'



#Establish which categories will appear when hovering over each node
HOVER_TOOLTIPS = [("Область", "@name"), ('Район', '@rayon') , ('Группа' , '@group') , ('ECI', '@eci') , ('Занятость' , '@Employment')]


#Create a plot — set dimensions, toolbar, and title
# tooltips = "name : @name , <br> group : @group, <br> pci : @pci, <br> Employment : @Employment",
plot = figure(
              tools="pan,wheel_zoom,save,reset", active_scroll='wheel_zoom',
            x_range=Range1d(-10000, 10000), y_range=Range1d(-10000, 10000), title=title , min_width=1000 )



plot.axis.visible = False

plot.add_tools(TapTool(), HoverTool(tooltips= HOVER_TOOLTIPS , attachment='vertical'))

network_graph = from_networkx(G, pos , scale=10, center=(0, 0))



#Set node size and color
network_graph.node_renderer.glyph = Circle(size='size', fill_color='color')
network_graph.node_renderer.selection_glyph = Circle(size='size', fill_color='color', line_color="#5a5a5a")
network_graph.node_renderer.hover_glyph = Circle(size='size', fill_color='color', line_color="red" )

#Set edge opacity and width
network_graph.edge_renderer.glyph = MultiLine(line_alpha=0.2, line_width=1)

network_graph.edge_renderer.selection_glyph = MultiLine(line_color='black', line_width=1)

network_graph.edge_renderer.hover_glyph = MultiLine(line_color='red', line_width=1 , line_dash='dashed')

network_graph.selection_policy = NodesAndLinkedEdges()
network_graph.inspection_policy = NodesAndLinkedEdges()


#Add network graph to the plot
plot.renderers.append(network_graph)


list_of_okeds = [
    ('all', 'Все'),
    ('64193',
  'Деятельность банка, являющегося национальным институтом развития, и его дочерней организации-лизингодателя'),
 ('84210', 'Международная деятельность'),
 ('85422', 'Послевузовское образование'),
 ('72204',
  'Междисциплинарные исследования и разработки в области экономического, бюджетного и стратегического планирования'),
 ('49314', 'Перевозки метрополитеном'),
 ('66112', 'Деятельность, связанная с управлением финансовыми рынками'),
 ('64300',
  'Деятельность трастовых компаний, инвестиционных фондов и аналогичных финансовых организаций'),
 ('72193',
  'Научные исследования и разработки в области космической деятельности'),
 ('62011', 'Разработка программного обеспечения'),
 ('69201', 'Деятельность по проведению финансовой ревизии (аудита)'),
 ('64911',
  'Финансовый лизинг, кроме финансового лизинга медицинского оборудования и техники'),
 ('70101',
  'Деятельность головных компаний, связанная с реализацией государственной политики индустриально-инновационного развития'),
 ('61201',
  'Беспроводная телекоммуникационная связь посредством единой транспортной среды'),
 ('69204',
  'Деятельность, связанная с неплатежеспособностью и взысканием задолженности'),
 ('62021',
  'Консультационные  и практические услуги в области информационных технологий'),
 ('61209', 'Прочая беспроводная телекоммуникационная связь'),
 ('79110', 'Деятельность туристских агентств'),
 ('70109', 'Деятельность прочих головных компаний'),
 ('27909',
  'Производство прочего электрического оборудования, не включенного в другие группировки'),
 ('68312',
  'Посреднические услуги при купле-продаже и сдаче внаем жилья и другого недвижимого имущества непроизводственного назначения'),
 ('73110', 'Деятельность рекламных агентств'),
 ('72195',
  'Исследования и разработки в области противоинфекционных препаратов'),
 ('53200', 'Прочая почтовая и курьерская деятельность'),
 ('64200', 'Деятельность холдинговых компаний'),
 ('28941', 'Производство машин и оборудования для текстильной промышленности'),
 ('65112', 'Негосударственное страхование жизни'),
 ('46909',
  'Оптовая торговля широким ассортиментом товаров без какой-либо конкретизации'),
 ('94200', 'Деятельность профессиональных союзов'),
 ('23910', 'Производство абразивных изделий'),
 ('63111',
  'Размещений приложений (прикладных программ) и связанная с этим деятельность'),
 ('58290', 'Издание прочего программного обеспечения'),
 ('58110', 'Издание книг'),
 ('45111',
  'Оптовая торговля автомобилями и легкими автотранспортными средствами'),
 ('51102',
  'Деятельность  воздушного пассажирского транспорта, не подчиняющегося расписанию'),
 ('69109', 'Прочая деятельность в области права'),
 ('28223', 'Производство оборудования непрерывного транспорта'),
 ('33160',
  'Ремонт и техническое обслуживание воздушных и космических летательных аппаратов'),
 ('28910', 'Производство машин и оборудования  для металлургии'),
 ('24340', 'Производство проволоки путем холодного волочения'),
 ('49100',
  'Деятельность пассажирского железнодорожного транспорта в междугородном сообщении'),
 ('20161',
  'Производство пластмасс в первичных формах, кроме полимеров из углеводородного сырья'),
 ('47411',
  'Розничная торговля компьютерами, периферийным оборудованием и программным обеспечением в специализированных магазинах, являющихся торговыми объектами, с торговой площадью менее 2000 кв.м '),
 ('62099',
  'Другие виды деятельности в области информационных технологий и информационных систем, не включенные в другие группировки'),
 ('28299', 'Производство прочих машин и оборудования, деталей  и узлов'),
 ('5103', 'Обогащение каменного угля'),
 ('74300', 'Деятельность по устному и письменному переводу'),
 ('10420', 'Производство маргарина и аналогичных пищевых жиров'),
 ('46450', 'Оптовая торговля парфюмерными и косметическими средствами'),
 ('64191',
  'Деятельность банков, за исключением, банка, являющегося национальным институтом развития, и его дочерней организации-лизингодателя'),
 ('65111', 'Государственное страхование жизни'),
 ('25113',
  'Производство строительных конструкций и изделий из алюминия и алюминиевых сплавов'),
 ('20120', 'Производство красителей и пигментов'),
 ('62012', 'Сопровождение программного обеспечения'),
 ('82300', 'Организация конференций и торговых выставок'),
 ('90013', 'Деятельность цирков'),
 ('59110',
  'Деятельность по производству кино-, видеофильмов и телевизионных программ'),
 ('46690', 'Оптовая торговля прочими машинами и оборудованием'),
 ('46461',
  'Оптовая торговля фармацевтическими товарами, кроме торговли медицинской техникой и ортопедическими изделиями'),
 ('47192',
  'Прочая розничная торговля в неспециализированных магазинах, являющихся торговыми объектами, с торговой площадью более 2000 кв.м (2000 кв.м и выше)'),
 ('84111', 'Деятельность республиканских органов управления'),
 ('23120', 'Формирование и обработка листового стекла'),
 ('82110',
  'Деятельность по предоставлению комплексных офисных административных услуг'),
 ('45113',
  'Розничная торговля автомобилями и легкими автотранспортными средствами в торговых объектах с торговой площадью более 2000 кв.м (2000 кв.м и выше)'),
 ('56101',
  'Деятельность ресторанов и предоставление услуг по доставке продуктов питания, за исключением деятельности объектов, находящихся на придорожной полосе'),
 ('65122', 'Негосударственное страхование ущерба'),
 ('26512', 'Производство электроизмерительных приборов'),
 ('46715', 'Оптовая торговля авиационным бензином и керосином'),
 ('93130', 'Деятельность фитнес-клубов'),
 ('18120', 'Прочие виды печатного производства'),
 ('46510',
  'Оптовая торговля компьютерами, периферийным компьютерным оборудованием и программным обеспечением'),
 ('60200', 'Деятельность по созданию и трансляции телевизионных программ'),
 ('26600',
  'Производство облучающего, электромедицинского и электротерапевтического оборудования'),
 ('25920', 'Производство упаковки из легких металлов'),
 ('24420', 'Производство алюминия'),
 ('24540', 'Литье прочих цветных металлов'),
 ('28292', 'Производство оборудования для фильтрования и очистки'),
 ('46370', 'Оптовая торговля кофе, чаем, какао и специями'),
 ('59130',
  'Деятельность по распространению кино-, видеофильмов и телевизионных программ'),
 ('85421', 'Высшее образование'),
 ('47910',
  'Розничная торговля путем заказа товаров по почте или через сеть Интернет'),
 ('28120', 'Производство гидравлического и пневматического оборудования'),
 ('45112',
  'Розничная торговля автомобилями и легкими автотранспортными средствами в торговых объектах с торговой площадью менее 2000 кв.м'),
 ('46432', 'Оптовая торговля радио- и телевизионным оборудованием'),
 ('64110', 'Деятельность национального банка'),
 ('47541',
  'Розничная торговля электрическими бытовыми приборами в специализированных магазинах, являющихся торговыми объектами, с торговой площадью менее 2000 кв.м  '),
 ('28991',
  'Производство нефтепромыслового и бурового геологоразведочного оборудования'),
 ('46480', 'Оптовая торговля часами и ювелирными изделиями'),
 ('74901', 'Деятельность гидрометеорологической службы'),
 ('74100', 'Специализированная дизайнерская деятельность'),
 ('69202', 'Деятельность в области составления счетов и бухгалтерского учета'),
 ('82912',
  'Деятельность агентств по сбору платежей и кредитных бюро, за исключением государственного'),
 ('17211', 'Производство гофрированной бумаги и картона'),
 ('94120', 'Деятельность профессиональных общественных организаций'),
 ('79900', 'Прочие услуги по бронированию и сопутствующая деятельность'),
 ('77400',
  'Лизинг продуктов интеллектуальной собственности и аналогичных  продуктов, кроме работ, защищенным авторским правом'),
 ('90012', 'Концертная деятельность'),
 ('41201', 'Строительство жилых зданий'),
 ('46431', 'Оптовая торговля бытовыми электротоварами'),
 ('46463',
  'Оптовая торговля медицинской техникой и ортопедическими  изделиями'),
 ('46462',
  'Оптовая реализация фармацевтических и медицинских товаров в рамках гарантированного объема бесплатной медицинской помощи'),
 ('45191', 'Оптовая торговля прочими автотранспортными средствами'),
 ('46737', 'Оптовая торговля санитарно-техническим оборудованием'),
 ('46520',
  'Оптовая торговля электронным и телекоммуникационным оборудованием и их частями '),
 ('74902', 'Аккредитация в области оценки соответствия'),
 ('84117', 'Деятельность в области статистики и социологии'),
 ('62031',
  'Деятельность по управлению информационно-коммуникационной инфраструктурой  в рамках формирования и развития государственных электронных информационных ресурсов и систем'),
 ('53100',
  'Почтовая деятельность  в рамках предоставления услуг общего пользования'),
 ('71204', 'Лабораторно-аналитические исследования в геологической отрасли'),
 ('68101', 'Покупка и продажа многоквартирных и жилых домов (особняков)'),
 ('27120', 'Производство электрораспределительной и регулирующей аппаратуры '),
 ('28999', 'Производство других машин специального назначения'),
 ('46470', 'Оптовая торговля мебелью, коврами и осветительным оборудованием'),
 ('29101', 'Производство автомобилей, кроме двигателей для автомобилей'),
 ('30301', 'Производство воздушных летательных аппаратов'),
 ('51101',
  'Деятельность  воздушного пассажирского транспорта, подчиняющегося расписанию'),
 ('65301', 'Государственное пенсионное обеспечение'),
 ('59200',
  'Деятельность в сфере звукозаписи и издания музыкальных произведений '),
 ('66220', 'Деятельность страховых агентов и брокеров'),
 ('52291', 'Транспортно-экспедиционные  услуги'),
 ('61909',
  'Прочая деятельность в области телекоммуникаций, не включенная в другие группировки'),
 ('59120',
  'Деятельность по завершению создания кино-, видеофильмов  и телевизионных программ'),
 ('68102', 'Покупка и продажа прочей недвижимости'),
 ('62022', 'Планирование и проектирование коммерческих информационных систем'),
 ('42130', 'Строительство мостов и туннелей'),
 ('64192', 'Деятельность сберегательных банков'),
 ('24452',
  'Производство титана, порошка из титана, магния, вольфрама и молибдена'),
 ('86102', 'Деятельность родильных домов'),
 ('45310',
  'Оптовая торговля автомобильными деталями, узлами и  принадлежностями '),
 ('77338', 'Аренда прочих офисных машин и оборудования'),
 ('41100', 'Разработка строительных проектов'),
 ('46752', 'Оптовая торговля резинотехническими изделиями'),
 ('72209',
  'Исследования и экспериментальные разработки в области общественных и гуманитарных наук, не включенные в другие группировки'),
 ('66190',
  'Прочая вспомогательная деятельность в сфере финансовых услуг, кроме страхования и пенсионного обеспечения'),
 ('46630',
  'Оптовая торговля машинами и оборудованием для горнодобывающей промышленности и  строительства'),
 ('71112',
  'Деятельность в области архитектуры, за исключением объектов атомной промышленности и атомной энергетики  '),
 ('52299', 'Прочая транспортно-экспедиционная деятельность'),
 ('46751', 'Оптовая торговля химическими веществами и химическими продуктами'),
 ('80101', 'Деятельность частных охранных служб'),
 ('46740',
  'Оптовая торговля скобяными изделиями, водопроводным и отопительным оборудованием и  инвентарем'),
 ('71125', 'Деятельность в области картографии'),
 ('23131', 'Производство стеклянной тары'),
 ('25290',
  'Производство прочих металлических цистерн, резервуаров и контейнеров'),
 ('49312', 'Перевозки трамваями'),
 ('60100', 'Радиовещание'),
 ('63112',
  'Информационно-методологическое обеспечение с сопровождением информационных систем и баз данных'),
 ('50200', 'Деятельность морского и прибрежного грузового транспорта'),
 ('90040', 'Деятельность концертных и театральных залов'),
 ('20511', 'Производство взрывчатых веществ и прочих пиротехнических изделий'),
 ('80102',
  'Деятельность охранных организаций, учрежденных национальными компаниями'),
 ('46360',
  'Оптовая торговля сахаром, шоколадом и сахаристыми кондитерскими изделиями'),
 ('6201', 'Добыча  природного газа, кроме метана'),
 ('32120', 'Производство ювелирных и аналогичных изделий'),
 ('72192',
  'Научно-исследовательские, опытно-методические и опытно-конструкторские работы в геологической отрасли'),
 ('90011', 'Театральная деятельность'),
 ('20599', 'Производство других химических продуктов'),
 ('79120', 'Деятельность туристских операторов'),
 ('68202', 'Аренда (субаренда) и эксплуатация арендуемой недвижимости'),
 ('20420', 'Производство парфюмерных и косметических средств'),
 ('28992', 'Производство нефтегазоперерабатывающего оборудования'),
 ('84112', 'Деятельность региональных органов управления'),
 ('31030', 'Производство матрасов'),
 ('46908',
  'Специализированная оптовая торговля товарами, не включенными в другие группировки'),
 ('94990',
  'Деятельность прочих общественных организаций, не включенных в другие группировки'),
 ('84300', 'Деятельность в области обязательного социального страхования'),
 ('61303',
  'Деятельность в области спутниковых телекоммуникаций для организации связи'),
 ('70221',
  'Консультирование по вопросам коммерческой деятельности и управления'),
 ('28921', 'Производство горношахтного и горнорудного оборудования'),
 ('46341',
  'Оптовая торговля напитками в магазинах, являющихся торговыми объектами, с торговой площадью менее 2000 кв.м'),
 ('72110',
  'Научные исследования и экспериментальные разработки в области биотехнологий'),
 ('46736', 'Оптовая торговля строительными металлическими конструкциями'),
 ('71123', 'Геодезическая деятельность'),
 ('32502', 'Производство медицинских инструментов, аппаратов  и оборудования'),
 ('51220', 'Деятельность космического транспорта'),
 ('69205',
  'Деятельность в области бухгалтерского, налогового учета и казначейских операций для национального управляющего холдинга'),
 ('46120',
  'Деятельность агентов по оптовой торговле топливом, рудами, металлами и химическими веществами'),
 ('47785',
  'Прочая розничная торговля в специализированных магазинах, являющихся торговыми объектами, с торговой площадью более 2000 кв.м (2000 кв.м и выше)'),
 ('72191',
  'Научные исследования и экспериментальные разработки в области проектирования, строительства, ремонта, содержания и диагностики автомобильных дорог и мостовых сооружений'),
 ('61109', 'Прочая проводная телекоммуникационная связь'),
 ('64992',
  'Другие финансовые услуги, финансирование в различных отраслях экономики, инвестиционная деятельность'),
 ('24511', 'Литье чугуна, кроме производства труб'),
 ('12002', 'Производство изделий из табака'),
 ('68201', 'Аренда и управление собственной недвижимостью'),
 ('46390',
  'Неспециализированная оптовая торговля продуктами питания, напитками и табачными изделиями'),
 ('64999',
  'Другие виды финансовых услуг, кроме страхования и пенсионного обеспечения, не включенные в другие группировки'),
 ('35304', 'Кондиционирование воздуха'),
 ('43299', 'Пуск и наладка смонтированного оборудования'),
 ('33141',
  'Ремонт и техническое обслуживание электродвигателей, генераторов и трансформаторов'),
 ('46731', 'Оптовая торговля листовым стеклом '),
 ('46389', 'Оптовая торговля прочими продуктами питания'),
 ('46734',
  'Оптовая торговля лакокрасочной продукцией, обоями и напольными покрытиями'),
 ('46350', 'Оптовая торговля табачными изделиями'),
 ('74909',
  'Иная профессиональная, научная и техническая деятельность, не включенная в другие группировки'),
 ('43123', 'Специальные работы в грунтах'),
 ('71121',
  'Деятельность в области инженерно-технического проектирования, за исключением объектов атомной промышленности и атомной энергетики'),
 ('93293', 'Деятельность кукольных театров'),
 ('96011', 'Стирка и обработка белья'),
 ('85592',
  'Виды образования, предоставляемые национальными компаниями и их дочерними организациями'),
 ('71209',
  'Деятельность прочих учреждений, осуществляющих технические испытания и анализы'),
 ('35111', 'Производство электроэнергии тепловыми электростанциями'),
 ('24330', 'Холодная штамповка или гибка'),
 ('27110', 'Производство электродвигателей, генераторов и трансформаторов '),
 ('46190',
  'Деятельность агентов по оптовой торговле товарами широкого ассортимента'),
 ('24200', 'Производство труб, трубок, полых профилей, фитингов из стали'),
 ('46499',
  'Оптовая торговля прочими непродовольственными товарами потребительского назначения, не включенными в другие группировки'),
 ('52232', 'Деятельность аэропортов'),
 ('42219', 'Строительство прочих трубопроводов'),
 ('86230', 'Стоматологическая деятельность'),
 ('25111', 'Производство строительных стальных конструкций'),
 ('49200', 'Деятельность грузового железнодорожного транспорта'),
 ('43122', 'Взрывные работы'),
 ('43219', 'Прочие электромонтажные работы'),
 ('71111',
  'Деятельность в области архитектуры для объектов атомной промышленности и атомной энергетики'),
 ('24455',
  'Производство редких, редкоземельных металлов и полупроводниковых материалов'),
 ('66122',
  'Брокерская деятельность по сделкам с ценными бумагами и товарами, за исключением деятельности, связанной с управлением активами Национального фонда, золотовалютными активами Национального Банка, пенсионными активами '),
 ('22220', 'Производство пластмассовых упаковок для товаров'),
 ('10830', 'Производство чая и кофе'),
 ('46140',
  'Деятельность агентов по оптовой  торговле машинами, оборудованием, судами и летательными аппаратами'),
 ('84250',
  'Деятельность по обеспечению безопасности в чрезвычайных ситуациях'),
 ('10820', 'Производство какао, шоколада и сахаристых кондитерских изделий'),
 ('27402', 'Производство осветительных приборов'),
 ('11010', 'Дистилляция, ректификация и смешивание спиртных напитков'),
 ('30400', 'Производство военных боевых транспортных средств'),
 ('46423', 'Оптовая торговля обувью'),
 ('42120', 'Строительство железных дорог и метро'),
 ('30200', 'Производство железнодорожных локомотивов и подвижного состава'),
 ('45192',
  'Розничная торговля прочими автотранспортными средствами в торговых объектах с торговой площадью менее 2000 кв.м'),
 ('91030',
  'Деятельность исторических мест и зданий и аналогичных туристических достопримечательностей'),
 ('17220',
  'Производство бумажных изделий хозяйственно-бытового и санитарно-гигиенического назначения'),
 ('24100', 'Производство чугуна, стали и ферросплавов'),
 ('49500', 'Деятельность трубопроводного транспорта'),
 ('35140', 'Продажа электроэнергии '),
 ('27903', 'Производство электрического сигнального оборудования'),
 ('33113', 'Ремонт паровых котлов, кроме котлов центрального отопления'),
 ('17212', 'Производство бумажной и картонной тары'),
 ('23611',
  'Производство сборных железобетонных и бетонных конструкций и изделий'),
 ('81210', 'Общая уборка зданий'),
 ('22210', 'Производство пластмассовых плит, листов, труб и профилей'),
 ('68321',
  'Управление недвижимостью за вознаграждение или на договорной основе'),
 ('20600', 'Производство искусственных и синтетических волокон'),
 ('91041', 'Деятельность ботанических садов и зоопарков'),
 ('23613', 'Производство силикатного кирпича'),
 ('43121', 'Земляные работы'),
 ('28221', 'Производство кранов (без строительных)'),
 ('27200', 'Производство батарей и аккумуляторов'),
 ('78100', 'Деятельность агентств по трудоустройству'),
 ('11050', 'Производство пива'),
 ('17290', 'Производство прочих изделий из бумаги и картона'),
 ('80200', 'Деятельность в области систем обеспечения безопасности'),
 ('86220', 'Специальная врачебная практика'),
 ('68311',
  'Посреднические услуги при купле-продаже и сдаче внаем недвижимого имущества производственно-технического назначения'),
 ('59140', 'Деятельность по показу кинофильмов'),
 ('87100',
  'Предоставление социальных услуг с услугами средних медицинских работников с обеспечением проживания'),
 ('20200', 'Производство пестицидов и прочей агрохимической продукции'),
 ('33151', 'Ремонт и техническое обслуживание судов'),
 ('21100', 'Производство основных фармацевтических продуктов'),
 ('24430', 'Производство свинца, цинка и олова'),
 ('62032',
  'Деятельность по управлению информационно-коммуникационным оборудованием'),
 ('47771',
  'Розничная торговля часами и ювелирными изделиями в специализированных магазинах, являющихся торговыми объектами, с торговой площадью менее 2000 кв.м'),
 ('24520', 'Литье стали'),
 ('90030', 'Художественное и литературное творчество'),
 ('46422',
  'Оптовая торговля одеждой, кроме трикотажных и чулочно-носочных изделий'),
 ('52219', 'Прочая вспомогательная деятельность  сухопутного транспорта'),
 ('23650', 'Производство изделий из асбестоцемента и волокнистого цемента'),
 ('73200', 'Исследование конъюнктуры рынка и изучение общественного мнения'),
 ('27320', 'Производство прочих электрических проводов и кабелей'),
 ('78200', 'Деятельность агентств по временному трудоустройству'),
 ('74903',
  'Деятельность ведомственных служб, занимающихся инновационными технологиями (медицинские, образовательные, консультационные и др.)'),
 ('46711', 'Оптовая торговля сырой нефтью и попутным газом'),
 ('33133',
  'Ремонт и техническое обслуживание облучающего, электромедицинского и электротерапевтического оборудования'),
 ('10412', 'Производство рафинированных масел и жиров'),
 ('46903',
  'Оптовая торговля широким ассортиментом товаров без какой-либо конкретизации в торговых объектах с торговой площадью более 2000 кв.м (2000 кв.м и выше), включая оптово-продовольственные распределительные центры'),
 ('46650', 'Оптовая торговля офисной мебелью'),
 ('63999', 'Прочие виды деятельности в области информационного обслуживания'),
 ('35121', 'Передача электроэнергии'),
 ('38220', 'Обработка и удаление опасных отходов'),
 ('28131', 'Производство вакуумных и воздушных насосов'),
 ('64921', 'Деятельность ломбардов'),
 ('20162',
  'Производство полимеров в первичных формах из углеводородного сырья'),
 ('21201', 'Производство фармацевтических препаратов'),
 ('52240', 'Транспортная обработка грузов'),
 ('47772',
  'Розничная торговля часами и ювелирными изделиями в специализированных магазинах, являющихся торговыми объектами, с торговой площадью более 2000 кв.м (2000 кв.м и выше)'),
 ('46771', 'Оптовая торговля ломом и отходами черных и цветных металлов'),
 ('77391',
  'Аренда прочих машин, оборудования и материальных активов, не включенных в другие группировки'),
 ('46762', 'Оптовая торговля прочими промежуточными продуктами'),
 ('9100',
  'Предоставление услуг, способствующих добыче нефти и природного газа'),
 ('23630', 'Производство товарного бетона'),
 ('23640', 'Производство строительных растворов'),
 ('13201', 'Производство хлопчатобумажных тканей'),
 ('73120', 'Размещение рекламы в средствах массовой информации'),
 ('55101',
  'Предоставление услуг гостиницами с ресторанами, за исключением гостиниц, находящихся на придорожной полосе'),
 ('25991', 'Производство металлического санитарно-технического оборудования'),
 ('93210', 'Деятельность развлекательных и тематических парков'),
 ('82200', 'Деятельность телефонных справочно-информационных служб'),
 ('46733',
  'Оптовая торговля изделиями из бетона, цемента, гипса и аналогичных материалов'),
 ('33125',
  'Ремонт и техническое обслуживание прочих машин и оборудования специального назначения'),
 ('22231', 'Производство пластмассовых изделий, используемых в строительстве'),
 ('20301',
  'Производство красок, лаков, эмалей и минеральных пигментов для них'),
 ('35114', 'Производство электроэнергии ветровыми электростанциями'),
 ('35115', 'Производство электроэнергии солнечными электростанциями'),
 ('25999', 'Производство прочих готовых металлических изделий'),
 ('16240', 'Производство деревянной тары'),
 ('62092', 'Деятельность в области кибербезопасности'),
 ('46440',
  'Оптовая торговля изделиями из керамики и стекла, чистящими средствами'),
 ('38322', 'Переработка отходов и лома цветных металлов'),
 ('86900', 'Прочая деятельность в области здравоохранения'),
 ('46722', 'Оптовая торговля чугуном, сталью и их литьем'),
 ('33124', 'Ремонт и техническое обслуживание станков'),
 ('10840', 'Производство пряностей и приправ'),
 ('81300', 'Деятельность по благоустройству территорий'),
 ('18110', 'Печатание газет'),
 ('93190', 'Прочая деятельность в области спорта'),
 ('15200', 'Производство обуви'),
 ('45402',
  'Розничная торговля мотоциклами, мотороллерами, деталями и принадлежностями к ним'),
 ('17230', 'Производство писчебумажных изделий'),
 ('81220',
  'Прочая деятельность (специализированная) по уборке зданий, чистке промышленных машин и оборудования'),
 ('46180',
  'Деятельность агентов, специализирующихся на оптовой торговле отдельными видами товаров или группами товаров, не включенными в другие группировки'),
 ('72199',
  'Прочие исследования и разработки в области естественных и технических наук '),
 ('47731',
  'Розничная торговля фармацевтическими товарами в специализированных магазинах, являющихся торговыми объектами, с торговой площадью менее 2000 кв.м'),
 ('86210', 'Общая врачебная практика'),
 ('35230', 'Продажа газообразного топлива по трубопроводам'),
 ('46719', 'Оптовая торговля прочим топливом'),
 ('25940', 'Производство крепежных и резьбовых изделий'),
 ('43992', 'Гидроизоляционные работы'),
 ('41202',
  'Строительство нежилых зданий, за исключением стационарных торговых объектов категорий 1, 2'),
 ('11070',
  'Производство безалкогольных напитков, минеральных вод и других вод в бутылках'),
 ('19201', 'Производство продуктов нефтепереработки'),
 ('46660', 'Оптовая торговля прочими офисными машинами и оборудованием'),
 ('33200', 'Монтаж, установка промышленных машин и оборудования'),
 ('25114', 'Производство контейнерных и сборно-разборных зданий и помещений'),
 ('14120', 'Производство спецодежды'),
 ('16210', 'Производство шпона, фанеры, плит и панелей из древесины'),
 ('35301', 'Производство тепловой энергии тепловыми сетями'),
 ('13950', 'Производство нетканых текстильных изделий, кроме одежды'),
 ('43211',
  'Электромонтажные работы по прокладке  телекоммуникационных, компьютерных и телевизионных сетей'),
 ('81100', 'Комплексное обслуживание объектов'),
 ('46721', 'Оптовая торговля рудами черных и цветных металлов'),
 ('52292', 'Технический надзор на транспорте'),
 ('69203', 'Консультрование в области налогообложения'),
 ('47591',
  'Розничная торговля мебелью в специализированных магазинах, являющихся торговыми объектами, с торговой площадью менее 2000 кв.м'),
 ('52231', 'Регулирование использования воздушного пространства'),
 ('42211', 'Строительство нефтяных и газовых магистральных трубопроводов'),
 ('47112',
  'Розничная торговля преимущественно продуктами питания,  напитками и табачными изделиями, в неспециализированных магазинах, являющихся торговыми объектами, с торговой площадью более 2000 кв.м (2000 кв.м и выше)'),
 ('33121', 'Ремонт и техническое обслуживание механического оборудования'),
 ('52239',
  'Прочая деятельность, относящаяся к пассажирским и грузовым перевозкам воздушным транспортом'),
 ('25720', 'Производство замков, петель и шарниров'),
 ('46421', 'Оптовая торговля трикотажными и чулочно-носочными изделиями'),
 ('33122',
  'Ремонт и техническое обслуживание прочего оборудования общего назначения'),
 ('18140',
  'Брошюровочно-переплетная, отделочная деятельность и сопутствующие услуги'),
 ('28924', 'Производство оборудования для обработки строительных материалов'),
 ('43390', 'Прочие отделочные работы'),
 ('28252', 'Производство кондиционеров воздуха, вентиляторов'),
 ('63910', 'Деятельность информационных агентств'),
 ('25112', 'Производство легких металлических конструкций'),
 ('49311', 'Перевозки автобусами'),
 ('23991', 'Производство асбестотехнических изделий'),
 ('22290', 'Производство прочих пластмассовых изделий'),
 ('47761',
  'Розничная торговля цветами в специализированных магазинах, являющихся торговыми объектами, с торговой площадью менее 2000 кв.м'),
 ('47212',
  'Розничная торговля фруктами и овощами в специализированных магазинах, являющихся  торговыми объектами, с торговой площадью более 2000 кв.м (2000 кв.м и выше)'),
 ('23995', 'Производство изделий из битума и аналогичных материалов'),
 ('38120', 'Сбор опасных отходов'),
 ('47301',
  'Розничная торговля моторным топливом в специализированных магазинах, за исключением находящихся на придорожной полосе'),
 ('46160',
  'Деятельность агентов по оптовой торговле текстильными изделиями, одеждой, обувью, изделиями из кожи и меха'),
 ('6100', 'Добыча сырой нефти и попутного газа'),
 ('47611',
  'Розничная торговля книгами в специализированных магазинах, являющихся торговыми объектами, с торговой площадью менее 2000 кв.м'),
 ('46410', 'Оптовая торговля текстильными изделиями'),
 ('47292',
  'Прочая розничная торговля продуктами питания в специализированных магазинах, являющихся торговыми объектами, с торговой площадью более 2000 кв.м (2000 кв.м и выше)'),
 ('14191', 'Производство головных уборов'),
 ('35220', 'Распределение газообразного топлива по трубопроводам'),
 ('63991',
  'Прочие виды деятельности, связанные с предоставлением компьютеризированных услуг телефонной связи'),
 ('32400', 'Производство игр и игрушек'),
 ('93291', 'Деятельность танцевальных залов, дискотек'),
 ('32503', 'Производство хирургических и ортопедических приспособлений'),
 ('47721',
  'Розничная торговля обувью в специализированных магазинах, являющихся торговыми объектами, с торговой площадью менее 2000 кв.м'),
 ('32993', 'Производство сувенирных изделий'),
 ('22111', 'Производство резиновых шин, покрышек и камер'),
 ('43220',
  'Монтаж систем водоснабжения, отопления и кондиционирования воздуха'),
 ('52103',
  'Складирование и хранение продовольственных товаров, кроме овощей и фруктов'),
 ('77321', 'Аренда строительных машин и оборудования '),
 ('47722',
  'Розничная торговля кожаными изделиями в специализированных магазинах, являющихся торговыми объектами, с торговой площадью менее 2000 кв.м'),
 ('52211', 'Эксплуатация железных дорог'),
 ('45321',
  'Розничная торговля автомобильными деталями, узлами и  принадлежностями в торговых объектах с торговой площадью менее 2000 кв.м'),
 ('42212',
  'Строительство трубопроводов для систем водоснабжения и канализации'),
 ('77341', 'Аренда водных транспортных средств и оборудования'),
 ('96090',
  'Предоставление прочих индивидуальных услуг, не включенных в другие группировки'),
 ('26200', 'Производство компьютеров и периферийного оборудования'),
 ('33131',
  'Ремонт и техническое обслуживание инструментов и приборов для измерения, тестирования и навигации'),
 ('85601',
  'Вспомогательная деятельность в области образования, предоставляемая национальными компаниями и их дочерними организациями'),
 ('10390', 'Прочие виды переработки и консервирования фруктов и овощей'),
 ('58190', 'Прочие виды издательской деятельности'),
 ('90020',
  'Деятельность, способствующая проведению культурно-зрелищных мероприятий'),
 ('47732',
  'Розничная торговля фармацевтическими товарами в специализированных магазинах, являющихся  торговыми объектами, с торговой площадью более 2000 кв.м (2000 кв.м и выше)'),
 ('52214', 'Деятельность автомобильных стоянок'),
 ('43993', 'Аренда строительного оборудования с оператором'),
 ('35130', 'Распределение электроэнергии'),
 ('45322',
  'Розничная торговля автомобильными деталями, узлами и  принадлежностями  в торговых объектах с торговой площадью более 2000 кв.м (2000 кв.м и выше)'),
 ('52104', 'Хранение нефти'),
 ('38323', 'Переработка неметаллических отходов'),
 ('84115', 'Деятельность, связанная с налогообложением'),
 ('84230', 'Деятельность в области юстиции и правосудия'),
 ('46732', 'Оптовая торговля цементом, песком и гравием'),
 ('13102', 'Прядение хлопчатобумажного волокна, хлопка-волокна'),
 ('46753', 'Оптовая торговля минеральными удобрениями'),
 ('84240', 'Деятельность по обеспечению общественного порядка и безопасности'),
 ('47741',
  'Розничная торговля медицинскими и ортопедическими товарами в специализированных магазинах, являющихся торговыми объектами, с торговой площадью менее 2000 кв.м'),
 ('47762',
  'Розничная торговля семенами и удобрениями в специализированных магазинах, являющихся торговыми объектами, с торговой площадью менее 2000 кв.м'),
 ('46220', 'Оптовая торговля цветами и другими растениями'),
 ('10520', 'Производство мороженого'),
 ('42220', 'Строительство линий электропередач и телекоммуникаций'),
 ('25710', 'Производство ножевых изделий'),
 ('20151', 'Производство удобрений'),
 ('28140', 'Производство прочих кранов, клапанов и вентилей'),
 ('46491', 'Оптовая торговля канцелярскими принадлежностями'),
 ('33111', 'Ремонт металлических цистерн, резервуаров и контейнеров'),
 ('46310', 'Оптовая торговля фруктами и овощами'),
 ('71122',
  'Деятельность по проведению геологической разведки и изысканий (без научных исследований и разработок)'),
 ('33190', 'Ремонт прочего оборудования'),
 ('82920', 'Упаковывание'),
 ('28302', 'Производство сельскохозяйственных машин'),
 ('47421',
  'Розничная торговля телекоммуникационным оборудованием в специализированных магазинах, являющихся торговыми объектами, с торговой площадью менее 2000 кв.м '),
 ('23523', 'Производство строительного гипса'),
 ('47651',
  'Розничная торговля играми и игрушками в специализированных магазинах, являющихся торговыми объектами, с торговой площадью менее 2000 кв.м'),
 ('13911', 'Производство  и обработка вязаного и трикотажного полотна'),
 ('46342',
  'Оптовая торговля напитками в магазинах, являющихся торговыми объектами, с торговой площадью более 2000 кв.м (2000 кв.м и выше), включая оптово-продовольственные распределительные центры'),
 ('20110', 'Производство промышленных газов'),
 ('25931', 'Производство изделий из проволоки'),
 ('69101', 'Адвокатская деятельность'),
 ('43298',
  'Прочие строительно-монтажные работы, не включенные в другие группировки'),
 ('78301',
  'Прочая деятельность по обеспечению трудовыми ресурсами (персоналом), кроме деятельности организаций, учрежденных национальными компаниями'),
 ('46754',
  'Оптовая торговля пестицидами и прочими агрохимическими продуктами'),
 ('43130', 'Разведочное бурение'),
 ('25210', 'Производство радиаторов и котлов центрального отопления'),
 ('11022', 'Производство вина из винограда несобственного производства'),
 ('10720',
  'Производство сухарей и печенья, мучных кондитерских изделий длительного хранения'),
 ('64929', 'Прочие виды кредитования, не включенные в другие группировки'),
 ('81290', 'Прочая деятельность по уборке'),
 ('46130',
  'Деятельность агентов по оптовой торговле древесиной и строительными материалами'),
 ('23522', 'Производство известняковой и доломитовой муки'),
 ('47892', 'Розничная торговля прочими товарами на рынках'),
 ('46610',
  'Оптовая торговля сельскохозяйственной техникой, оборудованием, деталями и принадлежностями к ним'),
 ('55909',
  'Предоставление услуг прочими местами для проживания, не включенными в другие категории'),
 ('46150',
  'Деятельность агентов по оптовой торговле мебелью, бытовыми товарами, скобяными и прочими металлическими изделиями'),
 ('46712', 'Оптовая торговля природным (горючим) газом'),
 ('92000', 'Деятельность по организации азартных игр и заключению пари'),
 ('95251', 'Ремонт наручных и прочих часов'),
 ('47303',
  'Розничная торговля моторным топливом в специализированных магазинах, находящихся на придорожной полосе'),
 ('47781',
  'Розничная торговля фотографическим, оптическим и точным оборудованием в специализированных магазинах, являющихся торговыми объектами, с торговой площадью менее 2000 кв.м'),
 ('24440', 'Производство меди'),
 ('47522',
  'Розничная торговля скобяными изделиями, лакокрасочными материалами и стеклом в специализированных магазинах, являющихся  торговыми объектами, с торговой площадью более 2000 кв.м (2000 кв.м и выше)'),
 ('49420', 'Предоставление услуг по переезду'),
 ('47751',
  'Розничная торговля косметическими товарами и туалетными принадлежностями в специализированных магазинах, являющихся торговыми объектами, с торговой площадью менее 2000 кв.м'),
 ('71127',
  'Деятельность по предоставлению инженерно-технических консультаций'),
 ('46330',
  'Оптовая торговля молочными продуктами, яйцами и пищевыми маслами и жирами'),
 ('38321', 'Переработка отходов и лома черных металлов'),
 ('47531',
  'Розничная торговля коврами, ковровыми изделиями, настенными и напольными покрытиями в специализированных магазинах, являющихся торговыми объектами, с торговой площадью менее 2000 кв.м '),
 ('42910', 'Строительство водных сооружений'),
 ('47593',
  'Розничная торговля мебелью в специализированных магазинах, являющихся торговыми объектами, с торговой площадью более 2000 кв.м (2000 кв.м и выше)'),
 ('95252', 'Ремонт ювелирных изделий'),
 ('28301', 'Производство сельскохозяйственных и лесохозяйственных тракторов '),
 ('31012',
  'Производство мебели для офисов и предприятий торговли, кроме стульев и другой мебели для сидения'),
 ('43340', 'Малярные и стекольные работы'),
 ('29201', 'Производство кузовов для автомобилей'),
 ('47641',
  'Розничная торговля спортивным оборудованием в специализированных магазинах, являющихся торговыми объектами, с торговой площадью менее 2000 кв.м'),
 ('24454', 'Обработка цветных металлов и сплавов'),
 ('43330', 'Покрытие полов и облицовка стен'),
 ('47763',
  'Розничная торговля домашними животными и кормами для домашних животных в специализированных магазинах, являющихся торговыми объектами, с торговой площадью менее 2000 кв.м'),
 ('47511',
  'Розничная торговля текстильными изделиями в специализированных магазинах, являющихся торговыми объектами, с торговой площадью менее 2000 кв.м '),
 ('42990',
  'Строительство прочих инженерных сооружений, не включенных в другие группировки'),
 ('33149',
  'Ремонт и техническое обслуживание прочего электрооборудования, не включенного в другие группировки'),
 ('84220', 'Оборонная деятельность'),
 ('23612', 'Производство стеновых блоков'),
 ('52102',
  'Складирование и хранение непродовольственных товаров, кроме зерна и нефти'),
 ('56210', 'Доставка готовой пищи на заказ'),
 ('46213', 'Оптовая торговля масличными культурами'),
 ('85609', 'Прочая вспомогательная деятельность в области образования'),
 ('86109', 'Деятельность других лечебных учреждений, имеющих стационары'),
 ('63120', 'Деятельность веб-порталов'),
 ('31020', 'Производство кухонной мебели'),
 ('43999', 'Прочие строительные работы, требующие специальной квалификации'),
 ('55103',
  'Предоставление гостиничных услуг с ресторанами для официальных мероприятий'),
 ('30110', 'Строительство судов и плавучих средств'),
 ('31090', 'Производство прочей мебели'),
 ('70210', 'Деятельность по взаимоотношениям и связью с общественностью'),
 ('20130', 'Производство прочих основных неорганических химических веществ'),
 ('33142',
  'Ремонт и техническое обслуживание электрораспределительной и регулирующей аппаратуры'),
 ('46230', 'Оптовая торговля живыми животными'),
 ('77210', 'Аренда и лизинг развлекательного и спортивного оборудования'),
 ('46170',
  'Деятельность агентов по оптовой торговле пищевыми продуктами, напитками и табачными изделиями'),
 ('46717', 'Оптовая торговля дизельным топливом'),
 ('38110', 'Сбор неопасных отходов'),
 ('62091',
  'Другие виды деятельности в области информационных технологий и информационных систем в рамках автоматизации функций государственных органов, учреждений и организаций'),
 ('45201',
  'Техническое обслуживание и ремонт автомобилей, за исключением произведенных станциями технического обслуживания, находящимися на придорожной полосе'),
 ('10730', 'Производство макаронных изделий'),
 ('5101', 'Добыча каменного угля открытым способом'),
 ('56299',
  'Прочая деятельность по обеспечению питанием, не включенная в другие группировки'),
 ('16231', 'Производство деревянных изделий для строительства'),
 ('20152', 'Производство азотосодержащих соединений'),
 ('23620', 'Производство изделий из гипса для строительных целей'),
 ('47992', 'Розничная торговля через сетевой маркетинг'),
 ('94110',
  'Деятельность коммерческих и предпринимательских общественных организаций'),
 ('82990',
  'Прочая деятельность по предоставлению вспомогательных коммерческих услуг, не включенная в другие группировки'),
 ('15111', 'Дубление и выделка кожи'),
 ('20410', 'Производство мыла и моющих, чистящих и полирующих средств'),
 ('13101', 'Подготовка хлопчатобумажного волокна, хлопка-волокна'),
 ('93120', 'Деятельность спортивных клубов'),
 ('47302',
  'Розничная торговля смазочными материалами в специализированных магазинах'),
 ('23310', 'Производство керамических покрытий и плит'),
 ('11021', 'Производство вина из винограда собственного производства'),
 ('47521',
  'Розничная торговля скобяными изделиями, лакокрасочными материалами и стеклом в специализированных магазинах, являющихся торговыми объектами, с торговой площадью менее 2000 кв.м '),
 ('47261',
  'Розничная торговля табачными изделиями в специализированных магазинах, являющихся торговыми объектами, с торговой площадью менее 2000 кв.м '),
 ('46735', 'Оптовая торговля древесиной и продукцией обработки древесины'),
 ('52220', 'Вспомогательная деятельность водного транспорта'),
 ('42112',
  'Деятельность по организации строительства, реконструкции, ремонта, платного движения и содержания автомобильных дорог (участков) общего пользования международного и республиканского значения'),
 ('46716', 'Оптовая торговля автомобильным бензином'),
 ('7102', 'Добыча железных руд открытым способом'),
 ('7295', 'Добыча и обогащение титаномагниевого сырья (руды)'),
 ('35303', 'Передача тепловой энергии'),
 ('43291', 'Изоляционные работы'),
 ('33119', 'Ремонт прочих металлических изделий'),
 ('47599',
  'Розничная торговля осветительными приборами и бытовыми товарами, не включенными в другие группировки, в специализированных магазинах, являющихся торговыми объектами, с торговой площадью менее 2000 кв.м'),
 ('24410', 'Производство благородных (драгоценных) металлов'),
 ('47714',
  'Розничная торговля одеждой, кроме трикотажных и чулочно-носочных изделий, в специализированных магазинах, являющихся торговыми объектами, с торговой площадью более 2000 кв.м (2000 кв.м и выше)'),
 ('52212', 'Эксплуатация автомобильных дорог'),
 ('14130', 'Производство прочей верхней одежды'),
 ('35306', 'Распределение тепловой энергии'),
 ('25501',
  'Производство готовых металлических изделий или полуфабрикатов путем ковки, прессования, штамповки и профилирования'),
 ('38210', 'Обработка и удаление неопасных отходов'),
 ('35112', 'Производство электроэнергии гидроэлектростанциями'),
 ('38310', 'Разборка машин и оборудования, не подлежащих восстановлению'),
 ('87900',
  'Ппредоставление прочих социальных услуг  с обеспечением проживания'),
 ('13960',
  'Производство прочих текстильных изделий технического и производственного назначения'),
 ('77290',
  'Аренда и лизинг прочих предметов личного потребления и бытовых товаров'),
 ('10613', 'Производство пищевых концентратов'),
 ('33179',
  'Ремонт прочих транспортных средств и оборудования, не включенных в другие группировки'),
 ('88100',
  'Предоставление социальных услуг без обеспечения проживания пожилым гражданам и инвалидам'),
 ('1612', 'Эксплуатация оросительных систем'),
 ('23521', 'Производство извести'),
 ('23690',
  'Производство прочих изделий из бетона, строительного гипса и цемента'),
 ('33171', 'Ремонт подвижного состава железных дорог'),
 ('13920', 'Производство готовых текстильных изделий, кроме одежды'),
 ('10899',
  'Производство прочих пищевых продуктов, не включенных в другие группировки'),
 ('22191', 'Производство резинотехнических изделий'),
 ('10910', 'Производство готовых кормов для сельскохозяйственных животных'),
 ('14199',
  'Производство прочих видов одежды и аксессуаров, не включенных в другие группировки'),
 ('32999', 'Производство прочих изделий'),
 ('45202',
  'Техническое обслуживание и ремонт автомобилей станциями технического обслуживания, находящимися на придорожной полосе'),
 ('43310', 'Штукатурные работы'),
 ('47431',
  'Розничная торговля аудио- и видеоаппаратурой в специализированных магазинах, являющихся торговыми объектами, с торговой площадью менее 2000 кв.м '),
 ('25610', 'Обработка металлов и нанесение покрытий на металлы'),
 ('50401', 'Деятельность речного  грузового транспорта, кроме лесосплава'),
 ('18130', 'Деятельность по подготовке материалов к печати и рапространению'),
 ('7101', 'Добыча железных руд подземным способом'),
 ('1192', 'Выращивание цветов, семеноводство цветочных культур'),
 ('56102',
  'Деятельность ресторанов и предоставление услуг по доставке продуктов питания объектами, находящимися на придорожной полосе'),
 ('96012', 'Химическая чистка и крашение'),
 ('31011', 'Производство стульев и другой мебели для сидения'),
 ('68203', 'Аренда и эксплуатация торгового рынка'),
 ('33143',
  'Ремонт и техническое обслуживание электроосветительного оборудования'),
 ('35119', 'Производство электроэнергии прочими электростанциями'),
 ('77111', 'Аренда легковых автомобилей и легких автотранспортных средств'),
 ('86103', 'Деятельность санаторно-курортных организаций'),
 ('10850', 'Производство готовых пищевых продуктов'),
 ('7293', 'Добыча и обогащение свинцово-цинковой руды'),
 ('16292', 'Производство декоративных изделий из дерева'),
 ('13930', 'Производство ковров и ковровых изделий'),
 ('77121', 'Аренда грузовых автомобилей'),
 ('47812',
  'Розничная торговля продуктами питания, напитками и табачными изделиями на рынках'),
 ('52213', 'Деятельность терминалов'),
 ('20149',
  'Производство прочих основных органических химических веществ, не включенных в другие группировки'),
 ('47221',
  'Розничная торговля домашней птицей, дичью и изделиями из них в специализированных магазинах, являющихся торговыми объектами, с торговой площадью менее 2000 кв.м '),
 ('46110',
  'Деятельность агентов по оптовой  торговле сельскохозяйственным сырьем, живыми животными, текстильным сырьем и полуфабрикатами'),
 ('56300', 'Подача напитков'),
 ('33126',
  'Ремонт и техническое обслуживание офисных машин и вычислительной техники'),
 ('25300', 'Производство паровых котлов, кроме котлов центрального отопления'),
 ('82190',
  'Деятельность по копированию, подготовке документов и прочая специализированная офисная вспомогательная деятельность'),
 ('14310', 'Производство вязаных и трикотажных чулочно-носочных  изделий'),
 ('23994',
  'Производство искусственных и переработка естественных пористых заполнителей'),
 ('47891',
  'Розничная торговля прочими товарами в торговых палатках, ларьках и киосках'),
 ('9900',
  'Предоставление услуг, способствующих добыче других полезных ископаемых'),
 ('47621',
  'Розничная торговля газетами, журналами и канцелярскими товарами в специализированных магазинах, являющихся торговыми объектами, с торговой площадью менее 2000 кв.м'),
 ('46320', 'Оптовая торговля мясом и мясными продуктами'),
 ('96020', 'Предоставление услуг парикмахерскими и салонами красоты'),
 ('46381', 'Оптовая торговля рыбой и рыбными продуктами'),
 ('47791',
  'Розничная торговля подержанными товарами в магазинах, являющихся торговыми объектами, с торговой площадью менее 2000 кв.м'),
 ('39000',
  'Деятельность по ликвидации загрязнений и прочие услуги в области удаления отходов'),
 ('32110', 'Чеканка/выпуск монет и медалей'),
 ('47999', 'Прочая розничная торговля вне магазинов'),
 ('25120', 'Производство металлических дверей и окон'),
 ('43110', 'Разборка и снос зданий и сооружений'),
 ('10611', 'Производство муки'),
 ('1240', 'Выращивание семечковых и косточковых плодов'),
 ('43910', 'Кровельные работы'),
 ('95120', 'Ремонт коммуникационного оборудования'),
 ('8122', 'Добыча глины и каолина'),
 ('25620', 'Основные технологические процессы машиностроения'),
 ('23200', 'Производство огнеупорных изделий'),
 ('47211',
  'Розничная торговля фруктами и овощами в специализированных магазинах, являющихся торговыми объектами, с торговой площадью менее 2000 кв.м '),
 ('43320', 'Столярные и плотницкие работы'),
 ('23992', 'Производство минеральных изоляционных материалов'),
 ('43991', 'Строительство шахт'),
 ('23510', 'Производство цемента'),
 ('88990',
  'Предоставление прочих социальных услуг без обеспечения проживания, не включенные в другие группировки'),
 ('10710',
  'Производство хлебобулочных и мучных кондитерских изделий недлительного хранения'),
 ('85591', 'Деятельность вечерних общеобразовательных школ'),
 ('23320',
  'Производство кирпича, черепицы и прочих строительных изделий из обожженной глины'),
 ('95240', 'Ремонт мебели и предметов интерьера'),
 ('47822',
  'Розничная торговля одеждой, обувью и текстильными изделиями на рынках'),
 ('1472', 'Производство яиц'),
 ('47241',
  'Розничная торговля хлебобулочными, мучными и сахаристыми кондитерскими изделиями в специализированных магазинах, являющихся торговыми объектами, с торговой площадью менее 2000 кв.м '),
 ('23700', 'Резка, обработка и отделка камня'),
 ('13999',
  'Производство других текстильных изделий, не включенных в другие группировки'),
 ('47712',
  'Розничная торговля одеждой, кроме трикотажных и чулочно-носочных изделий, в специализированных магазинах, являющихся торговыми объектами, с торговой площадью менее 2000 кв.м'),
 ('88910', 'Дневной уход за детьми'),
 ('49410', 'Деятельность грузового автомобильного транспорта'),
 ('47223',
  'Прочая розничная торговля мясом и мясными продуктами в специализированных магазинах, являющихся торговыми объектами, с торговой площадью более 2000 кв.м (2000 кв.м и выше)'),
 ('42111', 'Строительство дорог и автомагистралей'),
 ('7291', 'Добыча и обогащение алюминийсодержащего сырья'),
 ('3110', 'Морское рыболовство'),
 ('93110', 'Эксплуатация спортивных сооружений'),
 ('10612', 'Производство круп'),
 ('13300', 'Отделка тканей и текстильных изделий'),
 ('28151', 'Производство подшипников'),
 ('5201', 'Добыча лигнита (бурого угля) открытым способом'),
 ('85322', 'Среднее специальное образование'),
 ('85599',
  'Прочая деятельность в области образования, не включенная в другие группировки'),
 ('77311', 'Аренда сельскохозяйственных машин и оборудования'),
 ('2100', 'Лесоводство и прочая лесохозяйственная деятельность'),
 ('14390', 'Производство прочей вязаной и трикотажной одежды'),
 ('47713',
  'Розничная торговля трикотажными и чулочно-носочными изделиями в специализированных магазинах, являющихся торговыми объектами, с торговой площадью более 2000 кв.м (2000 кв.м и выше)'),
 ('10511', 'Переработка молока, кроме консервирования, и производство сыров'),
 ('7292', 'Добыча и обогащение медной руды'),
 ('8121', 'Разработка гравийных и песчаных карьеров'),
 ('49390',
  'Деятельность  прочего пассажирского сухопутного транспорта, не включенного в другие группировки'),
 ('8991', 'Добыча асбестовой руды'),
 ('95110', 'Ремонт компьютеров и периферийного оборудования'),
 ('85100', 'Дошкольное образование'),
 ('58140', 'Издание журналов и периодических публикаций'),
 ('47231',
  'Розничная торговля рыбой, ракообразными и моллюсками в специализированных магазинах, являющихся торговыми объектами, с торговой площадью менее 2000 кв.м '),
 ('95220', 'Ремонт бытовых приборов, домашнего и садового оборудования'),
 ('8112', 'Добыча известняка, гипса и мела'),
 ('10130', 'Производство продуктов из мяса и мяса сельскохозяйственной птицы'),
 ('10200', 'Переработка и консервирование рыбы, ракообразных и моллюсков'),
 ('1133', 'Выращивание сахарной свеклы и ее семян'),
 ('33112', 'Ремонт радиаторов и котлов центрального отопления'),
 ('95210', 'Ремонт  электронной бытовой техники'),
 ('46211', 'Оптовая торговля зерном, семенами и кормами для животных'),
 ('95292',
  'Ремонт швейных изделий, головных уборов и изделий текстильной галантереи'),
 ('95291', 'Ремонт трикотажных и вязаных изделий'),
 ('1473', 'Производство смешанное, мясояичное'),
 ('1700', 'Охота и отлов, включая предоставление услуг в этих областях'),
 ('87300',
  'Предоставление социальных услуг  пожилым гражданам и инвалидам с обеспечением проживания'),
 ('16291', 'Производство разных деревянных изделий'),
 ('47224',
  'Прочая розничная торговля мясом и мясными продуктами в специализированных магазинах, являющихся торговыми объектами, с торговой площадью менее 2000 кв.м '),
 ('95231', 'Ремонт обуви'),
 ('47711',
  'Розничная торговля трикотажными и чулочно-носочными изделиями в специализированных магазинах, являющихся торговыми объектами, с торговой площадью менее 2000 кв.м'),
 ('10411', 'Производство неочищенных масел и жиров'),
 ('10512', 'Производство молочных консервов'),
 ('55102',
  'Предоставление услуг гостиницами без ресторанов, за исключением гостиниц, находящихся на придорожной полосе'),
 ('96030', 'Организация похорон и связанная с этим деятельность'),
 ('35305', 'Производство тепловой энергии тепловыми электростанциями'),
 ('47789',
  'Прочая розничная торговля в специализированных магазинах, являющихся торговыми объектами, с торговой площадью менее 2000 кв.м'),
 ('95299',
  'Ремонт прочих предметов личного потребления и бытовых товаров, не включенных в другие группировки'),
 ('74200', 'Деятельность в области фотографии'),
 ('1132', 'Выращивание овощей, их семян и рассады'),
 ('10810', 'Производство сахара'),
 ('47991', 'Развозная и разносная розничная торговля'),
 ('49319', 'Перевозки прочими видами транспорта, подчиняющегося расписанию'),
 ('87200',
  'Предоставление социальных услуг с обеспечением проживания лицам, страдающим  психическими расстройствами (заболеваниями), с умственными и физическими недостатками, алкогольной или наркотической зависимостью'),
 ('46713', 'Оптовая торговля каменным углем'),
 ('85530', 'Деятельность школ подготовки водителей транспортных средств'),
 ('47811',
  'Розничная торговля продуктами питания, напитками и табачными изделиями в торговых палатках, ларьках и киосках'),
 ('91042', 'Деятельность природных заповедников, охрана дикой природы'),
 ('35302', 'Производство тепловой энергии самостоятельными котельными'),
 ('56291', 'Прочие виды организации питания вне населенных пунктов'),
 ('96040', 'Деятельность по обеспечению физического комфорта'),
 ('8111', 'Добыча отделочного и строительного камня'),
 ('91020', 'Деятельность музеев'),
 ('47821',
  'Розничная торговля одеждой, обувью и текстильными изделиями в торговых палатках, ларьках и киосках'),
 ('71201', 'Деятельность санитарно-эпидемиологических организаций'),
 ('47111',
  'Розничная торговля преимущественно продуктами питания, напитками и табачными изделиями в неспециализированных магазинах, являющихся торговыми объектами, с торговой площадью менее 2000 кв.м '),
 ('10110', 'Переработка и консервирование мяса'),
 ('7299',
  'Добыча и обогащение прочих металлических руд, не включенных в другие группировки'),
 ('20142', 'Производство биоэтанола'),
 ('1630', 'Деятельность по обработке урожая'),
 ('1611',
  'Деятельность, способствующая растениеводству, кроме эксплуатации оросительных систем'),
 ('47191',
  'Прочая розничная торговля в неспециализированных магазинах, являющихся торговыми объектами, с торговой площадью менее 2000 кв.м '),
 ('47251',
  'Розничная торговля напитками в специализированных магазинах, являющихся торговыми объектами, с торговой площадью менее 2000 кв.м '),
 ('55200',
  'Предоставление жилья на выходные дни и прочие периоды краткосрочного проживания'),
 ('8992', 'Добыча и обогащение неметаллических руд'),
 ('1250', 'Выращивание прочих плодов, ягод и орехов'),
 ('85321', 'Профессионально-техническое образование'),
 ('1440', 'Разведение верблюдов и прочих животных семейства верблюжьих'),
 ('7210', 'Добыча урановой и ториевой руд'),
 ('33123',
  'Ремонт и техническое обслуживание машин и оборудования для сельского и лесного хозяйства'),
 ('1161', 'Выращивание хлопка-сырца'),
 ('16101', 'Распиловка и строгание древесины'),
 ('10620', 'Производство крахмала и продукции из крахмала'),
 ('2400', 'Услуги, связанные с лесоводство и лесозаготовками'),
 ('58130', 'Издание газет'),
 ('36000', 'Сбор, обработка и распределение воды'),
 ('1120', 'Выращивание риса'),
 ('47291',
  'Прочая розничная торговля  продуктами питания в специализированных магазинах, являющихся торговыми объектами, с торговой площадью менее 2000 кв.м '),
 ('1191', 'Выращивание кормовых культур и их семян'),
 ('3220', 'Пресноводное рыбоводство'),
 ('37000', 'Сбор и обработка сточных вод'),
 ('64199', 'Денежное посредничество прочих финансовых учреждений'),
 ('7298', 'Добыча драгоценных металлов и руд редких металлов'),
 ('71124', 'Землеустройство'),
 ('85510', 'Образование в области спорта и отдыха'),
 ('94910', 'Деятельность религиозных организаций'),
 ('91013', 'Деятельность архивов'),
 ('1210', 'Выращивание винограда'),
 ('1471', 'Разведение птицы на мясо, племенной птицы и молодняка'),
 ('85200', 'Начальное образование (1-й уровень)'),
 ('1300', 'Воспроизводство растений'),
 ('10120', 'Переработка и консервирование мяса сельскохозяйственной птицы'),
 ('85520', 'Образование в области культуры'),
 ('8910',
  'Добыча минерального сырья для химической промышленности и производства удобрений'),
 ('49320', 'Деятельность такси'),
 ('1199',
  'Выращивание прочих одно- или двухлетних культур, не включенных в другие группировки'),
 ('1131', 'Выращивание картофеля и посадочного материала'),
 ('1290', 'Выращивание прочих многолетних культур'),
 ('8930', 'Добыча соли'),
 ('1112', 'Выращивание масличных культур и их семян'),
 ('86101',
  'Деятельность больниц широкого профиля и специализированных больниц'),
 ('3120', 'Пресноводное рыболовство'),
 ('85310', 'Основное и общее среднее образование'),
 ('1450', 'Разведение овец и коз'),
 ('1490', 'Разведение прочих видов животных'),
 ('1460', 'Разведение свиней'),
 ('84113', 'Деятельность местных органов управления'),
 ('84130',
  'Регулирование и содействие эффективному ведению экономической деятельности'),
 ('84120',
  'Регулирование деятельности учреждений здравоохранения, образования, культуры и других социальных услуг, кроме социального обеспечения'),
 ('1500', 'Смешанное сельское хозяйство'),
 ('2200', 'Лесозаготовки'),
 ('94920', 'Деятельность политических организаций'),
 ('52101', 'Складирование и хранение зерна'),
 ('91012',
  'Библиотечная деятельность, включая деятельность читальных залов, лекториев, демонстрационных залов'),
 ('93299', 'Прочие виды деятельности по организации отдыха и развлечений'),
 ('84114', 'Деятельность сельских и поселковых органов управления'),
 ('1431', 'Разведение лошадей'),
 ('75000', 'Ветеринарная деятельность'),
 ('1410', 'Разведение крупного рогатого скота молочного направления'),
 ('1111',
  'Выращивание зерновых и зернобобовых культур, включая семеноводство'),
 ('1620', 'Деятельность, способствующая животноводству'),
 ('1420', 'Разведение прочего крупного рогатого скота и буйволов')]


initial_node_data = copy.deepcopy(network_graph.node_renderer.data_source.data) #this is list

# Select menu

select = Select(title="Индустрия:", value=None, options=list_of_okeds, max_width = 150)


callback = CustomJS(args=dict(source=network_graph.node_renderer.data_source, node_data = initial_node_data), code="""
    const region_selected = cb_obj.value;
    console.log(region_selected);
    const node_region = node_data.okeds;
    console.log(node_region)
    const initial_colors = node_data.color
    var color = [];
    node_region.forEach(function (value, i) {
        //console.log(value);
        if (value.includes(region_selected)) {
            color.push(initial_colors[i])
        } else {
            color.push("#d3d3d3")
        }
        
    }) ;
    
    //var final_node_data = {} ; 
    //final_node_data['color'] = color ;
    //final_node_data['group'] = node_data.group;
    //final_node_data['name'] = node_data.name ;
    //final_node_data['okeds'] = node_data.okeds ; 
    //final_node_data['rayon'] = node_data.rayon ;
    //final_node_data['index'] = node_data.index ;
    //final_node_data['size'] = node_data.size;
    //final_node_data['eci'] = node_data.eci ;
    //final_node_data['Employment'] = node_data.Employment;
    
    if (region_selected == 'all') {
        source.data = node_data    
    } else {
        source.data.color = color;
        source.change.emit();
    }
    
    //source.data = final_node_data;
    

""")

#create legend
from bokeh.models import Div

legendEntries = {
'#8FAADC': 'Центрально-Восточный Казахстан',
 '#00B050': 'Северный Казахстан',
 '#000000': 'Западный Казахстан',
 '#AD85E4': 'Южный Казахстан',
 '#FF0000': 'Мегаполисы'}

with open ("resources/legend.css", "r") as f:
    legend_css=f.read()

with open ("resources/legend.html", "r") as f:
    legend_html=f.read()

def str_legend():
    return "<p>" + "</p><p>".join([f"<span class='legend-entry' style='background:{n}'>&nbsp;</span>{v}" for n, v in legendEntries.items()]) + "</p>"

div_legend = Div(css_classes=["legend-container"],
    text=f"<style>{legend_css}</style>{legend_html.replace('<p></p>',str_legend())}")



select.js_on_change("value", callback)

from bokeh.layouts import gridplot

layout = column(select , plot)

grid = gridplot([[div_legend, None], [ None, layout]])

output_file('region_space.html')
show(grid)

